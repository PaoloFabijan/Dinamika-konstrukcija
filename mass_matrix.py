import numpy as np

############################################
# Ulazni parametri [m], [m^2], [N], [kg/m^3]
############################################

mass_1 = 4/9.81
mass_2 = 2/9.81
mass_3 = 4/9.81

L1 = 0.32
L2 = 0.64

b = 0.003
h = 0.04
A = b*h
rho = 2710 #gustoÄ‡a aluminija

#####################################
# Lokalne matrice masa grede s 3 mase
#####################################

m1 = ((rho*A*L1)/420) * np.array([[156, 22*L1, 54, -13*L1], 
                                  [22*L1, 4*L1**2, 13*L1, -3*L1**2], 
                                  [54, 13*L1, 156, -22*L1], 
                                  [-13*L1, -3*L1**2, -22*L1, 4*L1**2]])

m2 = ((rho*A*L2)/420) * np.array([[156, 22*L2, 54, -13*L2], 
                                  [22*L2, 4*L2**2, 13*L2, -3*L2**2], 
                                  [54, 13*L2, 156, -22*L2], 
                                  [-13*L2, -3*L2**2, -22*L2, 4*L2**2]])

m3 = ((rho*A*L2)/420) * np.array([[156, 22*L2, 54, -13*L2], 
                                  [22*L2, 4*L2**2, 13*L2, -3*L2**2], 
                                  [54, 13*L2, 156, -22*L2], 
                                  [-13*L2, -3*L2**2, -22*L2, 4*L2**2]])

m4 = ((rho*A*L1)/420) * np.array([[156, 22*L1, 54, -13*L1], 
                                  [22*L1, 4*L1**2, 13*L1, -3*L1**2], 
                                  [54, 13*L1, 156, -22*L1], 
                                  [-13*L1, -3*L1**2, -22*L1, 4*L1**2]])

#######################
# Globalna matrica masa
#######################

M = np.zeros([10, 10])

for i in range(10):
    M[0:2, 0:4] = m1[0:2, 0:4]
    M[0:4, 0:2] = m1[0:4, 0:2]
    M[8:10, 6:10] = m4[2:4, 0:4]
    M[6:10, 8:10] = m4[0:4, 2:4]

    if i >= 2 and i <= 4:
        for i in range(2, 4, 2):
            M[i:i+2,i:i+2] = m1[2:4,2:4] + m2[0:2,0:2]
            M[i+2:i+4,i:i+2] = m2[2:4,0:2]
            M[i:i+2,i+2:i+4] = m2[0:2,2:4]
    
    if i >= 4 and i <= 6:
        for i in range(4, 6, 2):
            M[i:i+2,i:i+2] = m2[2:4,2:4] + m3[0:2,0:2]
            M[i+2:i+4,i:i+2] = m3[2:4,0:2]
            M[i:i+2,i+2:i+4] = m3[0:2,2:4]
    
    if i >= 6 and i <= 8:
        for i in range(6, 8, 2):
            M[i:i+2,i:i+2] = m3[2:4,2:4] + m4[0:2,0:2]
            M[i+2:i+4,i:i+2] = m4[2:4,0:2]
            M[i:i+2,i+2:i+4] = m4[0:2,2:4]

M[2, 2] = M[2, 2] + mass_1
M[4, 4] = M[4, 4] + mass_2
M[6, 6] = M[6, 6] + mass_3

# np.savetxt('Matrica_masa.csv', M, delimiter=',')